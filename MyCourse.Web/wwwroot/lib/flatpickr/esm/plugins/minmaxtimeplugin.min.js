import{calculateSecondsSinceMidnight,compareDates,compareTimes,createDateFormatter,parseSeconds}from"../utils/dates";function minMaxTimePlugin(a){void 0===a&&(a={});var o={formatDate:createDateFormatter({}),tableDateFormat:a.tableDateFormat||"Y-m-d",defaults:{minTime:void 0,maxTime:void 0}};return function(n){return{onReady:function(){o.formatDate=this.formatDate,o.defaults={minTime:this.config.minTime&&o.formatDate(this.config.minTime,"H:i"),maxTime:this.config.maxTime&&o.formatDate(this.config.maxTime,"H:i")},n.loadedPlugins.push("minMaxTime")},onChange:function(){var e,i,t,m=this.latestSelectedDateObj,e=m&&(e=m,void 0!==a.table?a.table[o.formatDate(e,o.tableDateFormat)]:a.getTimeLimits&&a.getTimeLimits(e));m&&void 0!==e?(this.set(e),n.config.minTime.setFullYear(m.getFullYear()),n.config.maxTime.setFullYear(m.getFullYear()),n.config.minTime.setMonth(m.getMonth()),n.config.maxTime.setMonth(m.getMonth()),n.config.minTime.setDate(m.getDate()),n.config.maxTime.setDate(m.getDate()),n.config.minTime>n.config.maxTime?(i=calculateSecondsSinceMidnight(n.config.minTime.getHours(),n.config.minTime.getMinutes(),n.config.minTime.getSeconds()),calculateSecondsSinceMidnight(n.config.maxTime.getHours(),n.config.maxTime.getMinutes(),n.config.maxTime.getSeconds())<(e=calculateSecondsSinceMidnight(m.getHours(),m.getMinutes(),m.getSeconds()))&&e<i&&(t=parseSeconds(i),n.setDate(new Date(m.getTime()).setHours(t[0],t[1],t[2]),!1))):0<compareDates(m,n.config.maxTime,!1)?n.setDate(new Date(m.getTime()).setHours(n.config.maxTime.getHours(),n.config.maxTime.getMinutes(),n.config.maxTime.getSeconds(),n.config.maxTime.getMilliseconds()),!1):compareDates(m,n.config.minTime,!1)<0&&n.setDate(new Date(m.getTime()).setHours(n.config.minTime.getHours(),n.config.minTime.getMinutes(),n.config.minTime.getSeconds(),n.config.minTime.getMilliseconds()),!1)):(i=o.defaults||{minTime:void 0,maxTime:void 0},this.set(i),m&&(i=(t=n.config).minTime,t=t.maxTime,i&&compareTimes(m,i)<0?n.setDate(new Date(m.getTime()).setHours(i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()),!1):t&&0<compareTimes(m,t)&&n.setDate(new Date(m.getTime()).setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()))))}}}}export default minMaxTimePlugin;